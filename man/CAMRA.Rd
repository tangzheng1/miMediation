% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CAMRA.R
\name{CAMRA}
\alias{CAMRA}
\title{CAMRA: Causal Absolute-abundance Mediation from Relative-Abundance data}
\usage{
CAMRA(
  mediators,
  exposure,
  outcome,
  confounders = NULL,
  pseudo = 0.5,
  fdr.alpha = 0.05,
  hdmt.exact = 0,
  screen = FALSE,
  seed = 42
)
}
\arguments{
\item{mediators}{A named numeric matrix containing microbiome abundance. Each row is a
subject and each column is a taxon. Column name contains the taxon name.}

\item{exposure}{A numeric vector of the exposure.}

\item{outcome}{A numeric vector of the outcome variable (currently treated as a continuous variable).}

\item{confounders}{An optional numeric vector or matrix containing confounders that may affect
the exposure, mediators and outcome. Each row is a subject and each column
is a specific confounder, e.g., age or sex. Default is NULL.}

\item{pseudo}{A numeric value for the pseudo-count added before log-ratio transformations. Default is 0.5.}

\item{fdr.alpha}{An optional numeric value for the desired FDR significance level in identifying
mediating nodes on the tree. Default is 0.05.}

\item{hdmt.exact}{An integer flag passed to HDMT::fdr_est controlling how mixture-null quantiles 
are computed: 0 = approximation method, 1 = exact method. Default is 0.}

\item{screen}{A logical value indicating whether to screen high-dimensional mediators before testing. 
Default is FALSE.}

\item{seed}{An integer seed for reproducibility. Default is 42.}
}
\value{
A list containing the following components:
\item{pval.alpha}{A numeric vector of p-values from the exposure-microbiome association test.}
\item{pval.beta}{A numeric vector of p-values from the microbiome-outcome association test (conditional on exposure).}
\item{qval.med}{A numeric vector of taxon-level mediation test q-values.}
\item{sig.mediators}{A vector of selected microbial mediators significant at the `fdr.alpha` level.}
}
\description{
CAMRA is a method for taxon-level microbiome mediator discovery that delivers 
well-calibrated error control. Unlike existing approaches that test mediation effects 
directly on the relative-abundance (RA) scale and can suffer from compositionality-induced 
false discoveries, CAMRA targets absolute-abundance (AA)–scale mediation effects by 
reconstructing AA-level exposure–microbiome and microbiome–outcome associations from RA inputs. 
CAMRA then combines the two path-specific signals under a composite-null mediation framework 
and reports taxon-wise q-values for mediator discovery.
}
\details{
CAMRA implements taxon-level mediation testing that targets absolute-abundance (AA)–scale 
mediation effects using standard sequencing relative-abundance (RA) count inputs. 
For each taxon \eqn{k}, CAMRA first estimates the exposure-to-microbiome association by applying 
PALM to obtain a path-specific p-value \eqn{p_{\alpha_k}}. It then estimates the 
microbiome-to-outcome association conditional on exposure using a PALAR-style regression 
with debiased inference to obtain \eqn{p_{\beta_k}}. 

These two path-specific signals are combined using the max-P joint-significance statistic 
\eqn{\max\{p_{\alpha_k}, p_{\beta_k}\}} for testing the composite mediation null 
\eqn{H_{0k}: \alpha_k \beta_k = 0}. Finally, CAMRA applies HDMT to obtain taxon-level 
q-values by explicitly accounting for the mixture structure of the composite null, enabling 
well-calibrated multiple-testing adjustment for mediator discovery.
}
\examples{
\donttest{
# Load the real dataset
data(data.bmi)

# Run CAMRA mediation screening
CAMRA_res <- CAMRA(
  mediators = data.bmi$mediators, 
  exposure = data.bmi$exposure, 
  outcome = data.bmi$outcome,
  confounders = NULL,
  fdr.alpha = 0.05,
  seed = 123
)

# View significant microbial mediators
print(CAMRA_res$sig.mediators)
}
}
\references{
Wang Q, Li Y, Peng Y, Tang, ZZ (2026). Error control in microbiome mediator discovery: benchmark and remedy. Submitted.

Wei Z, Hong Q, Chen G, Hartert TV, Rosas-Salazar C, Das SR, Shilts MH, Levin AM, Tang ZZ (2026). Fast and reliable association discovery in large-scale microbiome studies and meta-analyses using PALM. Genome Biology, accepted.

Li Y, Wang Q, Feng Z, Wang X, Tang ZZ (2025). PALAR: Estimation of absolute abundance effects in regression with relative abundance predictors. Journal of the American Statistical Association (JASA), DOI: 10.1080/01621459.2025.2596250.

Dai JY, Stanford JL, LeBlanc M (2020). A multiple-testing procedure for high-dimensional mediation hypotheses. Journal of the American Statistical Association (JASA), DOI: 10.1080/01621459.2020.1765785.
}
\author{
Qiyu Wang \email{wang_qy@mail.ustc.edu.cn}, Yunfei Peng \email{peng228@wisc.edu}
}
